var lvs_server_database = require('../lvs_server_database/schema');
var lvs_db = require('../lvs_db/schema');
var sequelize = require('sequelize');
var _ = require('underscore');

let query_string_0 = "SELECT serial_number FROM \
                            (SELECT wf.name AS 'wind_farm', wind_turbine_serial_id AS 'serial_number' FROM wind_farms wf \
                            LEFT JOIN wind_turbine_units wtu ON wtu.wind_farm_id_fk = wf.wind_farm_id \
                            LEFT JOIN value_map_wind_turbine_units_wind_turbine_coordinate_types vmct ON vmct.wind_turbine_serial_id_fk = wtu.wind_turbine_serial_id \
                                AND vmct.wind_turbine_coordinate_type_id_fk = 0 \
                            JOIN map_wind_turbine_units_wind_turbine_access_groups mag ON mag.wind_turbine_serial_id_fk = wtu.wind_turbine_serial_id \
                                AND mag.wind_turbine_access_group_id_fk = 0 \
                            WHERE 'auch die ungepflegten ausgeben' != 'ja' OR (vmct.coordinate_height IS NOT NULL) AND (vmct.coordinate_longitude IS NOT NULL AND vmct.coordinate_longitude > 0) \
                                    AND (vmct.coordinate_latitude IS NOT NULL AND vmct.coordinate_latitude > 0)) t2 \
                        WHERE wind_farm = (SELECT wind_farm  FROM \
                                    (SELECT wf.name AS 'wind_farm', wind_turbine_serial_id AS 'serial_number' FROM wind_farms wf \
                                    LEFT JOIN wind_turbine_units wtu ON wtu.wind_farm_id_fk = wf.wind_farm_id \
                                    LEFT JOIN value_map_wind_turbine_units_wind_turbine_coordinate_types vmct ON vmct.wind_turbine_serial_id_fk = wtu.wind_turbine_serial_id \
                                        AND vmct.wind_turbine_coordinate_type_id_fk = 0 \
                                    JOIN map_wind_turbine_units_wind_turbine_access_groups mag ON mag.wind_turbine_serial_id_fk = wtu.wind_turbine_serial_id \
                                        AND mag.wind_turbine_access_group_id_fk = 0 \
                                    WHERE 'auch die ungepflegten ausgeben' != 'ja' OR (vmct.coordinate_height IS NOT NULL) AND (vmct.coordinate_longitude IS NOT NULL AND vmct.coordinate_longitude > 0) \
                                    AND (vmct.coordinate_latitude IS NOT NULL AND vmct.coordinate_latitude > 0)) t1 \
                                WHERE serial_number = :turbine_id)"

let query_string_1 = "SELECT \
                            measuring_date as time, \
                            variable_id_fk, \
                            AVG(daily_avg)as value \
                        FROM \
                            (SELECT \
                                first_measuring_timestamp, \
                                    measuring_date, \
                                    wind_turbine_serial_id_fk, \
                                    variable_id_fk, \
                                    value_type_id_fk, \
                                    ((COALESCE(measuring_value_interval_1, 0) + COALESCE(measuring_value_interval_2, 0) + COALESCE(measuring_value_interval_3, 0) + COALESCE(measuring_value_interval_4, 0) + COALESCE(measuring_value_interval_5, 0) + COALESCE(measuring_value_interval_6, 0) + COALESCE(measuring_value_interval_7, 0) + COALESCE(measuring_value_interval_8, 0) + COALESCE(measuring_value_interval_9, 0) + COALESCE(measuring_value_interval_10, 0) + COALESCE(measuring_value_interval_11, 0) + COALESCE(measuring_value_interval_12, 0) + COALESCE(measuring_value_interval_13, 0) + COALESCE(measuring_value_interval_14, 0) + COALESCE(measuring_value_interval_15, 0) + COALESCE(measuring_value_interval_16, 0) + COALESCE(measuring_value_interval_17, 0) + COALESCE(measuring_value_interval_18, 0) + COALESCE(measuring_value_interval_19, 0) + COALESCE(measuring_value_interval_20, 0) + COALESCE(measuring_value_interval_21, 0) + COALESCE(measuring_value_interval_22, 0) + COALESCE(measuring_value_interval_23, 0) + COALESCE(measuring_value_interval_24, 0) + COALESCE(measuring_value_interval_25, 0) + COALESCE(measuring_value_interval_26, 0) + COALESCE(measuring_value_interval_27, 0) + COALESCE(measuring_value_interval_28, 0) + COALESCE(measuring_value_interval_29, 0) + COALESCE(measuring_value_interval_30, 0) + COALESCE(measuring_value_interval_31, 0) + COALESCE(measuring_value_interval_32, 0) + COALESCE(measuring_value_interval_33, 0) + COALESCE(measuring_value_interval_34, 0) + COALESCE(measuring_value_interval_35, 0) + COALESCE(measuring_value_interval_36, 0) + COALESCE(measuring_value_interval_37, 0) + COALESCE(measuring_value_interval_38, 0) + COALESCE(measuring_value_interval_39, 0) + COALESCE(measuring_value_interval_40, 0) + COALESCE(measuring_value_interval_41, 0) + COALESCE(measuring_value_interval_42, 0) + COALESCE(measuring_value_interval_43, 0) + COALESCE(measuring_value_interval_44, 0) + COALESCE(measuring_value_interval_45, 0) + COALESCE(measuring_value_interval_46, 0) + COALESCE(measuring_value_interval_47, 0) + COALESCE(measuring_value_interval_48, 0) + COALESCE(measuring_value_interval_49, 0) + COALESCE(measuring_value_interval_50, 0) + COALESCE(measuring_value_interval_51, 0) + COALESCE(measuring_value_interval_52, 0) + COALESCE(measuring_value_interval_53, 0) + COALESCE(measuring_value_interval_54, 0) + COALESCE(measuring_value_interval_55, 0) + COALESCE(measuring_value_interval_56, 0) + COALESCE(measuring_value_interval_57, 0) + COALESCE(measuring_value_interval_58, 0) + COALESCE(measuring_value_interval_59, 0) + COALESCE(measuring_value_interval_60, 0) + COALESCE(measuring_value_interval_61, 0) + COALESCE(measuring_value_interval_62, 0) + COALESCE(measuring_value_interval_63, 0) + COALESCE(measuring_value_interval_64, 0) + COALESCE(measuring_value_interval_65, 0) + COALESCE(measuring_value_interval_66, 0) + COALESCE(measuring_value_interval_67, 0) + COALESCE(measuring_value_interval_68, 0) + COALESCE(measuring_value_interval_69, 0) + COALESCE(measuring_value_interval_70, 0) + COALESCE(measuring_value_interval_71, 0) + COALESCE(measuring_value_interval_72, 0) + COALESCE(measuring_value_interval_73, 0) + COALESCE(measuring_value_interval_74, 0) + COALESCE(measuring_value_interval_75, 0) + COALESCE(measuring_value_interval_76, 0) + COALESCE(measuring_value_interval_77, 0) + COALESCE(measuring_value_interval_78, 0) + COALESCE(measuring_value_interval_79, 0) + COALESCE(measuring_value_interval_80, 0) + COALESCE(measuring_value_interval_81, 0) + COALESCE(measuring_value_interval_82, 0) + COALESCE(measuring_value_interval_83, 0) + COALESCE(measuring_value_interval_84, 0) + COALESCE(measuring_value_interval_85, 0) + COALESCE(measuring_value_interval_86, 0) + COALESCE(measuring_value_interval_87, 0) + COALESCE(measuring_value_interval_88, 0) + COALESCE(measuring_value_interval_89, 0) + COALESCE(measuring_value_interval_90, 0) + COALESCE(measuring_value_interval_91, 0) + COALESCE(measuring_value_interval_92, 0) + COALESCE(measuring_value_interval_93, 0) + COALESCE(measuring_value_interval_94, 0) + COALESCE(measuring_value_interval_95, 0) + COALESCE(measuring_value_interval_96, 0) + COALESCE(measuring_value_interval_97, 0) + COALESCE(measuring_value_interval_98, 0) + COALESCE(measuring_value_interval_99, 0) + COALESCE(measuring_value_interval_100, 0) + COALESCE(measuring_value_interval_101, 0) + COALESCE(measuring_value_interval_102, 0) + COALESCE(measuring_value_interval_103, 0) + COALESCE(measuring_value_interval_104, 0) + COALESCE(measuring_value_interval_105, 0) + COALESCE(measuring_value_interval_106, 0) + COALESCE(measuring_value_interval_107, 0) + COALESCE(measuring_value_interval_108, 0) + COALESCE(measuring_value_interval_109, 0) + COALESCE(measuring_value_interval_110, 0) + COALESCE(measuring_value_interval_111, 0) + COALESCE(measuring_value_interval_112, 0) + COALESCE(measuring_value_interval_113, 0) + COALESCE(measuring_value_interval_114, 0) + COALESCE(measuring_value_interval_115, 0) + COALESCE(measuring_value_interval_116, 0) + COALESCE(measuring_value_interval_117, 0) + COALESCE(measuring_value_interval_118, 0) + COALESCE(measuring_value_interval_119, 0) + COALESCE(measuring_value_interval_120, 0) + COALESCE(measuring_value_interval_121, 0) + COALESCE(measuring_value_interval_122, 0) + COALESCE(measuring_value_interval_123, 0) + COALESCE(measuring_value_interval_124, 0) + COALESCE(measuring_value_interval_125, 0) + COALESCE(measuring_value_interval_126, 0) + COALESCE(measuring_value_interval_127, 0) + COALESCE(measuring_value_interval_128, 0) + COALESCE(measuring_value_interval_129, 0) + COALESCE(measuring_value_interval_130, 0) + COALESCE(measuring_value_interval_131, 0) + COALESCE(measuring_value_interval_132, 0) + COALESCE(measuring_value_interval_133, 0) + COALESCE(measuring_value_interval_134, 0) + COALESCE(measuring_value_interval_135, 0) + COALESCE(measuring_value_interval_136, 0) + COALESCE(measuring_value_interval_137, 0) + COALESCE(measuring_value_interval_138, 0) + COALESCE(measuring_value_interval_139, 0) + COALESCE(measuring_value_interval_140, 0) + COALESCE(measuring_value_interval_141, 0) + COALESCE(measuring_value_interval_142, 0) + COALESCE(measuring_value_interval_143, 0) + COALESCE(measuring_value_interval_144, 0)) / ((IF(measuring_value_interval_1 IS NULL, 0, 1) + IF(measuring_value_interval_2 IS NULL, 0, 1) + IF(measuring_value_interval_3 IS NULL, 0, 1) + IF(measuring_value_interval_4 IS NULL, 0, 1) + IF(measuring_value_interval_5 IS NULL, 0, 1) + IF(measuring_value_interval_6 IS NULL, 0, 1) + IF(measuring_value_interval_7 IS NULL, 0, 1) + IF(measuring_value_interval_8 IS NULL, 0, 1) + IF(measuring_value_interval_9 IS NULL, 0, 1) + IF(measuring_value_interval_10 IS NULL, 0, 1) + IF(measuring_value_interval_11 IS NULL, 0, 1) + IF(measuring_value_interval_12 IS NULL, 0, 1) + IF(measuring_value_interval_13 IS NULL, 0, 1) + IF(measuring_value_interval_14 IS NULL, 0, 1) + IF(measuring_value_interval_15 IS NULL, 0, 1) + IF(measuring_value_interval_16 IS NULL, 0, 1) + IF(measuring_value_interval_17 IS NULL, 0, 1) + IF(measuring_value_interval_18 IS NULL, 0, 1) + IF(measuring_value_interval_19 IS NULL, 0, 1) + IF(measuring_value_interval_20 IS NULL, 0, 1) + IF(measuring_value_interval_21 IS NULL, 0, 1) + IF(measuring_value_interval_22 IS NULL, 0, 1) + IF(measuring_value_interval_23 IS NULL, 0, 1) + IF(measuring_value_interval_24 IS NULL, 0, 1) + IF(measuring_value_interval_25 IS NULL, 0, 1) + IF(measuring_value_interval_26 IS NULL, 0, 1) + IF(measuring_value_interval_27 IS NULL, 0, 1) + IF(measuring_value_interval_28 IS NULL, 0, 1) + IF(measuring_value_interval_29 IS NULL, 0, 1) + IF(measuring_value_interval_30 IS NULL, 0, 1) + IF(measuring_value_interval_31 IS NULL, 0, 1) + IF(measuring_value_interval_32 IS NULL, 0, 1) + IF(measuring_value_interval_33 IS NULL, 0, 1) + IF(measuring_value_interval_34 IS NULL, 0, 1) + IF(measuring_value_interval_35 IS NULL, 0, 1) + IF(measuring_value_interval_36 IS NULL, 0, 1) + IF(measuring_value_interval_37 IS NULL, 0, 1) + IF(measuring_value_interval_38 IS NULL, 0, 1) + IF(measuring_value_interval_39 IS NULL, 0, 1) + IF(measuring_value_interval_40 IS NULL, 0, 1) + IF(measuring_value_interval_41 IS NULL, 0, 1) + IF(measuring_value_interval_42 IS NULL, 0, 1) + IF(measuring_value_interval_43 IS NULL, 0, 1) + IF(measuring_value_interval_44 IS NULL, 0, 1) + IF(measuring_value_interval_45 IS NULL, 0, 1) + IF(measuring_value_interval_46 IS NULL, 0, 1) + IF(measuring_value_interval_47 IS NULL, 0, 1) + IF(measuring_value_interval_48 IS NULL, 0, 1) + IF(measuring_value_interval_49 IS NULL, 0, 1) + IF(measuring_value_interval_50 IS NULL, 0, 1) + IF(measuring_value_interval_51 IS NULL, 0, 1) + IF(measuring_value_interval_52 IS NULL, 0, 1) + IF(measuring_value_interval_53 IS NULL, 0, 1) + IF(measuring_value_interval_54 IS NULL, 0, 1) + IF(measuring_value_interval_55 IS NULL, 0, 1) + IF(measuring_value_interval_56 IS NULL, 0, 1) + IF(measuring_value_interval_57 IS NULL, 0, 1) + IF(measuring_value_interval_58 IS NULL, 0, 1) + IF(measuring_value_interval_59 IS NULL, 0, 1) + IF(measuring_value_interval_60 IS NULL, 0, 1) + IF(measuring_value_interval_61 IS NULL, 0, 1) + IF(measuring_value_interval_62 IS NULL, 0, 1) + IF(measuring_value_interval_63 IS NULL, 0, 1) + IF(measuring_value_interval_64 IS NULL, 0, 1) + IF(measuring_value_interval_65 IS NULL, 0, 1) + IF(measuring_value_interval_66 IS NULL, 0, 1) + IF(measuring_value_interval_67 IS NULL, 0, 1) + IF(measuring_value_interval_68 IS NULL, 0, 1) + IF(measuring_value_interval_69 IS NULL, 0, 1) + IF(measuring_value_interval_70 IS NULL, 0, 1) + IF(measuring_value_interval_71 IS NULL, 0, 1) + IF(measuring_value_interval_72 IS NULL, 0, 1) + IF(measuring_value_interval_73 IS NULL, 0, 1) + IF(measuring_value_interval_74 IS NULL, 0, 1) + IF(measuring_value_interval_75 IS NULL, 0, 1) + IF(measuring_value_interval_76 IS NULL, 0, 1) + IF(measuring_value_interval_77 IS NULL, 0, 1) + IF(measuring_value_interval_78 IS NULL, 0, 1) + IF(measuring_value_interval_79 IS NULL, 0, 1) + IF(measuring_value_interval_80 IS NULL, 0, 1) + IF(measuring_value_interval_81 IS NULL, 0, 1) + IF(measuring_value_interval_82 IS NULL, 0, 1) + IF(measuring_value_interval_83 IS NULL, 0, 1) + IF(measuring_value_interval_84 IS NULL, 0, 1) + IF(measuring_value_interval_85 IS NULL, 0, 1) + IF(measuring_value_interval_86 IS NULL, 0, 1) + IF(measuring_value_interval_87 IS NULL, 0, 1) + IF(measuring_value_interval_88 IS NULL, 0, 1) + IF(measuring_value_interval_89 IS NULL, 0, 1) + IF(measuring_value_interval_90 IS NULL, 0, 1) + IF(measuring_value_interval_91 IS NULL, 0, 1) + IF(measuring_value_interval_92 IS NULL, 0, 1) + IF(measuring_value_interval_93 IS NULL, 0, 1) + IF(measuring_value_interval_94 IS NULL, 0, 1) + IF(measuring_value_interval_95 IS NULL, 0, 1) + IF(measuring_value_interval_96 IS NULL, 0, 1) + IF(measuring_value_interval_97 IS NULL, 0, 1) + IF(measuring_value_interval_98 IS NULL, 0, 1) + IF(measuring_value_interval_99 IS NULL, 0, 1) + IF(measuring_value_interval_100 IS NULL, 0, 1) + IF(measuring_value_interval_101 IS NULL, 0, 1) + IF(measuring_value_interval_102 IS NULL, 0, 1) + IF(measuring_value_interval_103 IS NULL, 0, 1) + IF(measuring_value_interval_104 IS NULL, 0, 1) + IF(measuring_value_interval_105 IS NULL, 0, 1) + IF(measuring_value_interval_106 IS NULL, 0, 1) + IF(measuring_value_interval_107 IS NULL, 0, 1) + IF(measuring_value_interval_108 IS NULL, 0, 1) + IF(measuring_value_interval_109 IS NULL, 0, 1) + IF(measuring_value_interval_110 IS NULL, 0, 1) + IF(measuring_value_interval_111 IS NULL, 0, 1) + IF(measuring_value_interval_112 IS NULL, 0, 1) + IF(measuring_value_interval_113 IS NULL, 0, 1) + IF(measuring_value_interval_114 IS NULL, 0, 1) + IF(measuring_value_interval_115 IS NULL, 0, 1) + IF(measuring_value_interval_116 IS NULL, 0, 1) + IF(measuring_value_interval_117 IS NULL, 0, 1) + IF(measuring_value_interval_118 IS NULL, 0, 1) + IF(measuring_value_interval_119 IS NULL, 0, 1) + IF(measuring_value_interval_120 IS NULL, 0, 1) + IF(measuring_value_interval_121 IS NULL, 0, 1) + IF(measuring_value_interval_122 IS NULL, 0, 1) + IF(measuring_value_interval_123 IS NULL, 0, 1) + IF(measuring_value_interval_124 IS NULL, 0, 1) + IF(measuring_value_interval_125 IS NULL, 0, 1) + IF(measuring_value_interval_126 IS NULL, 0, 1) + IF(measuring_value_interval_127 IS NULL, 0, 1) + IF(measuring_value_interval_128 IS NULL, 0, 1) + IF(measuring_value_interval_129 IS NULL, 0, 1) + IF(measuring_value_interval_130 IS NULL, 0, 1) + IF(measuring_value_interval_131 IS NULL, 0, 1) + IF(measuring_value_interval_132 IS NULL, 0, 1) + IF(measuring_value_interval_133 IS NULL, 0, 1) + IF(measuring_value_interval_134 IS NULL, 0, 1) + IF(measuring_value_interval_135 IS NULL, 0, 1) + IF(measuring_value_interval_136 IS NULL, 0, 1) + IF(measuring_value_interval_137 IS NULL, 0, 1) + IF(measuring_value_interval_138 IS NULL, 0, 1) + IF(measuring_value_interval_139 IS NULL, 0, 1) + IF(measuring_value_interval_140 IS NULL, 0, 1) + IF(measuring_value_interval_141 IS NULL, 0, 1) + IF(measuring_value_interval_142 IS NULL, 0, 1) + IF(measuring_value_interval_143 IS NULL, 0, 1) + IF(measuring_value_interval_144 IS NULL, 0, 1)))) AS daily_avg, \'farm' AS wind_farm \
                            FROM \
                                lvs_measuring_data.wind_turbine_unit_measuring_data_daily \
                            WHERE \
                                wind_turbine_serial_id_fk IN (:turbines) \
                                    AND variable_id_fk IN (:variables) \
                                    AND value_type_id_fk IN (:type) \
                                    AND measuring_date >= :start_date \
                                    AND measuring_date <= :end_date) t1 \
                        GROUP BY measuring_date, variable_id_fk \
                        ORDER BY measuring_date"




 exports.getSameFarmTurbines = function (params, callback) {

     lvs_server_database.sequelize.query(query_string_0, {
         replacements:{
             turbine_id: params.turbines
         },
         type: sequelize.QueryTypes.SELECT
     }).then(function(data) {
         let turbines = _.map(data, function(x) {
             return x['serial_number']
         })
      callback(true, 200, "Success", turbines);
  }).catch(function(err) {
      console.log(err)
      callback(false, 300, "Error : " +  err, {});
  });
 }

 exports.getDayLevelFarmLevelMean = function (turbines, params, callback) {
     lvs_db.sequelize.query(query_string_1, {
         replacements:{
            turbines: [turbines],
            variables:[params.variable] ,
            start_date: params.start_date ,
            end_date: params.end_date ,
            type:params.type
         },
         type: sequelize.QueryTypes.SELECT
     }).then(function(data) {
      callback(true, 200, "Success", data);
  }).catch(function(err) {
      console.log(err)
      callback(false, 300, "Error : " +  err, {});
  });
 }

 exports.get10MinLevelFarmLevelMean = function(turbines, params, callback) {


   let query_string_10_min = "SELECT  time, variable_id_fk, avg(value) as value  from"+
                "(SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*10 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_1   AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t2  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*20 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_2  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t3  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*30 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_3  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t4  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*40 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_4  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t5  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*50 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_5  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t6  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*60 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_6  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t7  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*70 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_7  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t8  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*80 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_8  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t9  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*90 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_9  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t10  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*100 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_10  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t11  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*110 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_11  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t12  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*120 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_12  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t13  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*130 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_13  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t14  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*140 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_14  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t15  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*150 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_15  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t16  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*160 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_16  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t17  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*170 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_17  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t18  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*180 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_18  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t19  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*190 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_19  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t20  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*200 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_20  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t21  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*210 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_21  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t22  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*220 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_22  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t23  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*230 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_23  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t24  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*240 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_24  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t25  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*250 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_25  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t26  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*260 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_26  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t27  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*270 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_27  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t28  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*280 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_28  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t29  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*290 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_29  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t30  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*300 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_30  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t31  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*310 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_31  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t32  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*320 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_32  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t33  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*330 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_33  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t34  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*340 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_34  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t35  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*350 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_35  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t36  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*360 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_36  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t37  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*370 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_37  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t38  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*380 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_38  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t39  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*390 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_39  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t40  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*400 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_40  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t41  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*410 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_41  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t42  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*420 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_42  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t43  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*430 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_43  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t44  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*440 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_44  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t45  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*450 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_45  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t46  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*460 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_46  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t47  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*470 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_47  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t48  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*480 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_48  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t49  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*490 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_49  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t50  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*500 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_50  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t51  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*510 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_51  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t52  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*520 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_52  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t53  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*530 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_53  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t54  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*540 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_54  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t55  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*550 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_55  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t56  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*560 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_56  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t57  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*570 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_57  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t58  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*580 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_58  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t59  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*590 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_59  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t60  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*600 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_60  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t61  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*610 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_61  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t62  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*620 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_62  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t63  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*630 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_63  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t64  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*640 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_64  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t65  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*650 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_65  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t66  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*660 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_66  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t67  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*670 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_67  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t68  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*680 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_68  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t69  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*690 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_69  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t70  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*700 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_70  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t71  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*710 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_71  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t72  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*720 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_72  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t73  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*730 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_73  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t74  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*740 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_74  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t75  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*750 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_75  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t76  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*760 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_76  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t77  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*770 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_77  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t78  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*780 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_78  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t79  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*790 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_79  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t80  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*800 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_80  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t81  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*810 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_81  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t82  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*820 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_82  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t83  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*830 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_83  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t84  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*840 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_84  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t85  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*850 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_85  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t86  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*860 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_86  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t87  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*870 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_87  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t88  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*880 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_88  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t89  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*890 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_89  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t90  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*900 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_90  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t91  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*910 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_91  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t92  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*920 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_92  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t93  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*930 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_93  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t94  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*940 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_94  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t95  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*950 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_95  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t96  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*960 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_96  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t97  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*970 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_97  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t98  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*980 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_98  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t99  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*990 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_99  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date  and measuring_date <= :end_date    and value_type_id_fk = :type) t100  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1000 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_100  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t101  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1010 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_101  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t102  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1020 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_102  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t103  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1030 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_103  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t104  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1040 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_104  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t105  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1050 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_105  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t106  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1060 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_106  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t107  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1070 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_107  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t108  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1080 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_108  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t109  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1090 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_109  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t110  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1100 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_110  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t111  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1110 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_111  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t112  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1120 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_112  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t113  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1130 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_113  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t114  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1140 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_114  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t115  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1150 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_115  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t116  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1160 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_116  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t117  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1170 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_117  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t118  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1180 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_118  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t119  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1190 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_119  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t120  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1200 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_120  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t121  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1210 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_121  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t122  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1220 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_122  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t123  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1230 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_123  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t124  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1240 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_124  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t125  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1250 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_125  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t126  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1260 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_126  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t127  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1270 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_127  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date  and measuring_date <= :end_date    and value_type_id_fk = :type) t128  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1280 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_128  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t129  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1290 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_129  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t130  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1300 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_130  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t131  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1310 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_131  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t132  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1320 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_132  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t133  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1330 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_133  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t134  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1340 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_134  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t135  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1350 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_135  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t136  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1360 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_136  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t137  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1370 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_137  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t138  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1380 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_138  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t139  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1390 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_139  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t140  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1400 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_140  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t141  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1410 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_141  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t142  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1420 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_142  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t143  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1430 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_143  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t144  "+
                " UNION ALL SELECT measuring_date,(UNIX_TIMESTAMP(measuring_date)*1000)+(60000*1440 )AS time, wind_turbine_serial_id_fk , variable_id_fk, measuring_value_interval_144  AS value FROM (SELECT * FROM lvs_measuring_data.wind_turbine_unit_measuring_data_daily where  wind_turbine_serial_id_fk in ("+turbines+")  and variable_id_fk in ("+params.variable+") and measuring_date >= :start_date and measuring_date <= :end_date    and value_type_id_fk = :type) t145) t_stage  "+
                " GROUP BY time , variable_id_fk  "+
                " ORDER BY time"

 lvs_db.sequelize.query(query_string_10_min, {
         replacements:{
            // turbines: [turbines],
            // variables:[params.variable] ,
            start_date: params.start_date ,
            end_date: params.end_date ,
            type:params.type
         },
         type: sequelize.QueryTypes.SELECT
     }).then(function(data) {
      callback(true, 200, "Success", data);
  }).catch(function(err) {
      console.log(err)
      callback(false, 300, "Error : " +  err, {});
  });



}



exports.getFarmLevelAverage = function(turbines, params, callback) {
   let query_string = " SELECT \
                            variable_id_fk, value_type_id_fk, \
                            AVG(daily_avg)as value \
                        FROM \
                            (SELECT \
                                first_measuring_timestamp, \
                                    measuring_date, \
                                    wind_turbine_serial_id_fk, \
                                    variable_id_fk, \
                                    value_type_id_fk, \
                                    ((COALESCE(measuring_value_interval_1, 0) + COALESCE(measuring_value_interval_2, 0) + COALESCE(measuring_value_interval_3, 0) + COALESCE(measuring_value_interval_4, 0) + COALESCE(measuring_value_interval_5, 0) + COALESCE(measuring_value_interval_6, 0) + COALESCE(measuring_value_interval_7, 0) + COALESCE(measuring_value_interval_8, 0) + COALESCE(measuring_value_interval_9, 0) + COALESCE(measuring_value_interval_10, 0) + COALESCE(measuring_value_interval_11, 0) + COALESCE(measuring_value_interval_12, 0) + COALESCE(measuring_value_interval_13, 0) + COALESCE(measuring_value_interval_14, 0) + COALESCE(measuring_value_interval_15, 0) + COALESCE(measuring_value_interval_16, 0) + COALESCE(measuring_value_interval_17, 0) + COALESCE(measuring_value_interval_18, 0) + COALESCE(measuring_value_interval_19, 0) + COALESCE(measuring_value_interval_20, 0) + COALESCE(measuring_value_interval_21, 0) + COALESCE(measuring_value_interval_22, 0) + COALESCE(measuring_value_interval_23, 0) + COALESCE(measuring_value_interval_24, 0) + COALESCE(measuring_value_interval_25, 0) + COALESCE(measuring_value_interval_26, 0) + COALESCE(measuring_value_interval_27, 0) + COALESCE(measuring_value_interval_28, 0) + COALESCE(measuring_value_interval_29, 0) + COALESCE(measuring_value_interval_30, 0) + COALESCE(measuring_value_interval_31, 0) + COALESCE(measuring_value_interval_32, 0) + COALESCE(measuring_value_interval_33, 0) + COALESCE(measuring_value_interval_34, 0) + COALESCE(measuring_value_interval_35, 0) + COALESCE(measuring_value_interval_36, 0) + COALESCE(measuring_value_interval_37, 0) + COALESCE(measuring_value_interval_38, 0) + COALESCE(measuring_value_interval_39, 0) + COALESCE(measuring_value_interval_40, 0) + COALESCE(measuring_value_interval_41, 0) + COALESCE(measuring_value_interval_42, 0) + COALESCE(measuring_value_interval_43, 0) + COALESCE(measuring_value_interval_44, 0) + COALESCE(measuring_value_interval_45, 0) + COALESCE(measuring_value_interval_46, 0) + COALESCE(measuring_value_interval_47, 0) + COALESCE(measuring_value_interval_48, 0) + COALESCE(measuring_value_interval_49, 0) + COALESCE(measuring_value_interval_50, 0) + COALESCE(measuring_value_interval_51, 0) + COALESCE(measuring_value_interval_52, 0) + COALESCE(measuring_value_interval_53, 0) + COALESCE(measuring_value_interval_54, 0) + COALESCE(measuring_value_interval_55, 0) + COALESCE(measuring_value_interval_56, 0) + COALESCE(measuring_value_interval_57, 0) + COALESCE(measuring_value_interval_58, 0) + COALESCE(measuring_value_interval_59, 0) + COALESCE(measuring_value_interval_60, 0) + COALESCE(measuring_value_interval_61, 0) + COALESCE(measuring_value_interval_62, 0) + COALESCE(measuring_value_interval_63, 0) + COALESCE(measuring_value_interval_64, 0) + COALESCE(measuring_value_interval_65, 0) + COALESCE(measuring_value_interval_66, 0) + COALESCE(measuring_value_interval_67, 0) + COALESCE(measuring_value_interval_68, 0) + COALESCE(measuring_value_interval_69, 0) + COALESCE(measuring_value_interval_70, 0) + COALESCE(measuring_value_interval_71, 0) + COALESCE(measuring_value_interval_72, 0) + COALESCE(measuring_value_interval_73, 0) + COALESCE(measuring_value_interval_74, 0) + COALESCE(measuring_value_interval_75, 0) + COALESCE(measuring_value_interval_76, 0) + COALESCE(measuring_value_interval_77, 0) + COALESCE(measuring_value_interval_78, 0) + COALESCE(measuring_value_interval_79, 0) + COALESCE(measuring_value_interval_80, 0) + COALESCE(measuring_value_interval_81, 0) + COALESCE(measuring_value_interval_82, 0) + COALESCE(measuring_value_interval_83, 0) + COALESCE(measuring_value_interval_84, 0) + COALESCE(measuring_value_interval_85, 0) + COALESCE(measuring_value_interval_86, 0) + COALESCE(measuring_value_interval_87, 0) + COALESCE(measuring_value_interval_88, 0) + COALESCE(measuring_value_interval_89, 0) + COALESCE(measuring_value_interval_90, 0) + COALESCE(measuring_value_interval_91, 0) + COALESCE(measuring_value_interval_92, 0) + COALESCE(measuring_value_interval_93, 0) + COALESCE(measuring_value_interval_94, 0) + COALESCE(measuring_value_interval_95, 0) + COALESCE(measuring_value_interval_96, 0) + COALESCE(measuring_value_interval_97, 0) + COALESCE(measuring_value_interval_98, 0) + COALESCE(measuring_value_interval_99, 0) + COALESCE(measuring_value_interval_100, 0) + COALESCE(measuring_value_interval_101, 0) + COALESCE(measuring_value_interval_102, 0) + COALESCE(measuring_value_interval_103, 0) + COALESCE(measuring_value_interval_104, 0) + COALESCE(measuring_value_interval_105, 0) + COALESCE(measuring_value_interval_106, 0) + COALESCE(measuring_value_interval_107, 0) + COALESCE(measuring_value_interval_108, 0) + COALESCE(measuring_value_interval_109, 0) + COALESCE(measuring_value_interval_110, 0) + COALESCE(measuring_value_interval_111, 0) + COALESCE(measuring_value_interval_112, 0) + COALESCE(measuring_value_interval_113, 0) + COALESCE(measuring_value_interval_114, 0) + COALESCE(measuring_value_interval_115, 0) + COALESCE(measuring_value_interval_116, 0) + COALESCE(measuring_value_interval_117, 0) + COALESCE(measuring_value_interval_118, 0) + COALESCE(measuring_value_interval_119, 0) + COALESCE(measuring_value_interval_120, 0) + COALESCE(measuring_value_interval_121, 0) + COALESCE(measuring_value_interval_122, 0) + COALESCE(measuring_value_interval_123, 0) + COALESCE(measuring_value_interval_124, 0) + COALESCE(measuring_value_interval_125, 0) + COALESCE(measuring_value_interval_126, 0) + COALESCE(measuring_value_interval_127, 0) + COALESCE(measuring_value_interval_128, 0) + COALESCE(measuring_value_interval_129, 0) + COALESCE(measuring_value_interval_130, 0) + COALESCE(measuring_value_interval_131, 0) + COALESCE(measuring_value_interval_132, 0) + COALESCE(measuring_value_interval_133, 0) + COALESCE(measuring_value_interval_134, 0) + COALESCE(measuring_value_interval_135, 0) + COALESCE(measuring_value_interval_136, 0) + COALESCE(measuring_value_interval_137, 0) + COALESCE(measuring_value_interval_138, 0) + COALESCE(measuring_value_interval_139, 0) + COALESCE(measuring_value_interval_140, 0) + COALESCE(measuring_value_interval_141, 0) + COALESCE(measuring_value_interval_142, 0) + COALESCE(measuring_value_interval_143, 0) + COALESCE(measuring_value_interval_144, 0)) / ((IF(measuring_value_interval_1 IS NULL, 0, 1) + IF(measuring_value_interval_2 IS NULL, 0, 1) + IF(measuring_value_interval_3 IS NULL, 0, 1) + IF(measuring_value_interval_4 IS NULL, 0, 1) + IF(measuring_value_interval_5 IS NULL, 0, 1) + IF(measuring_value_interval_6 IS NULL, 0, 1) + IF(measuring_value_interval_7 IS NULL, 0, 1) + IF(measuring_value_interval_8 IS NULL, 0, 1) + IF(measuring_value_interval_9 IS NULL, 0, 1) + IF(measuring_value_interval_10 IS NULL, 0, 1) + IF(measuring_value_interval_11 IS NULL, 0, 1) + IF(measuring_value_interval_12 IS NULL, 0, 1) + IF(measuring_value_interval_13 IS NULL, 0, 1) + IF(measuring_value_interval_14 IS NULL, 0, 1) + IF(measuring_value_interval_15 IS NULL, 0, 1) + IF(measuring_value_interval_16 IS NULL, 0, 1) + IF(measuring_value_interval_17 IS NULL, 0, 1) + IF(measuring_value_interval_18 IS NULL, 0, 1) + IF(measuring_value_interval_19 IS NULL, 0, 1) + IF(measuring_value_interval_20 IS NULL, 0, 1) + IF(measuring_value_interval_21 IS NULL, 0, 1) + IF(measuring_value_interval_22 IS NULL, 0, 1) + IF(measuring_value_interval_23 IS NULL, 0, 1) + IF(measuring_value_interval_24 IS NULL, 0, 1) + IF(measuring_value_interval_25 IS NULL, 0, 1) + IF(measuring_value_interval_26 IS NULL, 0, 1) + IF(measuring_value_interval_27 IS NULL, 0, 1) + IF(measuring_value_interval_28 IS NULL, 0, 1) + IF(measuring_value_interval_29 IS NULL, 0, 1) + IF(measuring_value_interval_30 IS NULL, 0, 1) + IF(measuring_value_interval_31 IS NULL, 0, 1) + IF(measuring_value_interval_32 IS NULL, 0, 1) + IF(measuring_value_interval_33 IS NULL, 0, 1) + IF(measuring_value_interval_34 IS NULL, 0, 1) + IF(measuring_value_interval_35 IS NULL, 0, 1) + IF(measuring_value_interval_36 IS NULL, 0, 1) + IF(measuring_value_interval_37 IS NULL, 0, 1) + IF(measuring_value_interval_38 IS NULL, 0, 1) + IF(measuring_value_interval_39 IS NULL, 0, 1) + IF(measuring_value_interval_40 IS NULL, 0, 1) + IF(measuring_value_interval_41 IS NULL, 0, 1) + IF(measuring_value_interval_42 IS NULL, 0, 1) + IF(measuring_value_interval_43 IS NULL, 0, 1) + IF(measuring_value_interval_44 IS NULL, 0, 1) + IF(measuring_value_interval_45 IS NULL, 0, 1) + IF(measuring_value_interval_46 IS NULL, 0, 1) + IF(measuring_value_interval_47 IS NULL, 0, 1) + IF(measuring_value_interval_48 IS NULL, 0, 1) + IF(measuring_value_interval_49 IS NULL, 0, 1) + IF(measuring_value_interval_50 IS NULL, 0, 1) + IF(measuring_value_interval_51 IS NULL, 0, 1) + IF(measuring_value_interval_52 IS NULL, 0, 1) + IF(measuring_value_interval_53 IS NULL, 0, 1) + IF(measuring_value_interval_54 IS NULL, 0, 1) + IF(measuring_value_interval_55 IS NULL, 0, 1) + IF(measuring_value_interval_56 IS NULL, 0, 1) + IF(measuring_value_interval_57 IS NULL, 0, 1) + IF(measuring_value_interval_58 IS NULL, 0, 1) + IF(measuring_value_interval_59 IS NULL, 0, 1) + IF(measuring_value_interval_60 IS NULL, 0, 1) + IF(measuring_value_interval_61 IS NULL, 0, 1) + IF(measuring_value_interval_62 IS NULL, 0, 1) + IF(measuring_value_interval_63 IS NULL, 0, 1) + IF(measuring_value_interval_64 IS NULL, 0, 1) + IF(measuring_value_interval_65 IS NULL, 0, 1) + IF(measuring_value_interval_66 IS NULL, 0, 1) + IF(measuring_value_interval_67 IS NULL, 0, 1) + IF(measuring_value_interval_68 IS NULL, 0, 1) + IF(measuring_value_interval_69 IS NULL, 0, 1) + IF(measuring_value_interval_70 IS NULL, 0, 1) + IF(measuring_value_interval_71 IS NULL, 0, 1) + IF(measuring_value_interval_72 IS NULL, 0, 1) + IF(measuring_value_interval_73 IS NULL, 0, 1) + IF(measuring_value_interval_74 IS NULL, 0, 1) + IF(measuring_value_interval_75 IS NULL, 0, 1) + IF(measuring_value_interval_76 IS NULL, 0, 1) + IF(measuring_value_interval_77 IS NULL, 0, 1) + IF(measuring_value_interval_78 IS NULL, 0, 1) + IF(measuring_value_interval_79 IS NULL, 0, 1) + IF(measuring_value_interval_80 IS NULL, 0, 1) + IF(measuring_value_interval_81 IS NULL, 0, 1) + IF(measuring_value_interval_82 IS NULL, 0, 1) + IF(measuring_value_interval_83 IS NULL, 0, 1) + IF(measuring_value_interval_84 IS NULL, 0, 1) + IF(measuring_value_interval_85 IS NULL, 0, 1) + IF(measuring_value_interval_86 IS NULL, 0, 1) + IF(measuring_value_interval_87 IS NULL, 0, 1) + IF(measuring_value_interval_88 IS NULL, 0, 1) + IF(measuring_value_interval_89 IS NULL, 0, 1) + IF(measuring_value_interval_90 IS NULL, 0, 1) + IF(measuring_value_interval_91 IS NULL, 0, 1) + IF(measuring_value_interval_92 IS NULL, 0, 1) + IF(measuring_value_interval_93 IS NULL, 0, 1) + IF(measuring_value_interval_94 IS NULL, 0, 1) + IF(measuring_value_interval_95 IS NULL, 0, 1) + IF(measuring_value_interval_96 IS NULL, 0, 1) + IF(measuring_value_interval_97 IS NULL, 0, 1) + IF(measuring_value_interval_98 IS NULL, 0, 1) + IF(measuring_value_interval_99 IS NULL, 0, 1) + IF(measuring_value_interval_100 IS NULL, 0, 1) + IF(measuring_value_interval_101 IS NULL, 0, 1) + IF(measuring_value_interval_102 IS NULL, 0, 1) + IF(measuring_value_interval_103 IS NULL, 0, 1) + IF(measuring_value_interval_104 IS NULL, 0, 1) + IF(measuring_value_interval_105 IS NULL, 0, 1) + IF(measuring_value_interval_106 IS NULL, 0, 1) + IF(measuring_value_interval_107 IS NULL, 0, 1) + IF(measuring_value_interval_108 IS NULL, 0, 1) + IF(measuring_value_interval_109 IS NULL, 0, 1) + IF(measuring_value_interval_110 IS NULL, 0, 1) + IF(measuring_value_interval_111 IS NULL, 0, 1) + IF(measuring_value_interval_112 IS NULL, 0, 1) + IF(measuring_value_interval_113 IS NULL, 0, 1) + IF(measuring_value_interval_114 IS NULL, 0, 1) + IF(measuring_value_interval_115 IS NULL, 0, 1) + IF(measuring_value_interval_116 IS NULL, 0, 1) + IF(measuring_value_interval_117 IS NULL, 0, 1) + IF(measuring_value_interval_118 IS NULL, 0, 1) + IF(measuring_value_interval_119 IS NULL, 0, 1) + IF(measuring_value_interval_120 IS NULL, 0, 1) + IF(measuring_value_interval_121 IS NULL, 0, 1) + IF(measuring_value_interval_122 IS NULL, 0, 1) + IF(measuring_value_interval_123 IS NULL, 0, 1) + IF(measuring_value_interval_124 IS NULL, 0, 1) + IF(measuring_value_interval_125 IS NULL, 0, 1) + IF(measuring_value_interval_126 IS NULL, 0, 1) + IF(measuring_value_interval_127 IS NULL, 0, 1) + IF(measuring_value_interval_128 IS NULL, 0, 1) + IF(measuring_value_interval_129 IS NULL, 0, 1) + IF(measuring_value_interval_130 IS NULL, 0, 1) + IF(measuring_value_interval_131 IS NULL, 0, 1) + IF(measuring_value_interval_132 IS NULL, 0, 1) + IF(measuring_value_interval_133 IS NULL, 0, 1) + IF(measuring_value_interval_134 IS NULL, 0, 1) + IF(measuring_value_interval_135 IS NULL, 0, 1) + IF(measuring_value_interval_136 IS NULL, 0, 1) + IF(measuring_value_interval_137 IS NULL, 0, 1) + IF(measuring_value_interval_138 IS NULL, 0, 1) + IF(measuring_value_interval_139 IS NULL, 0, 1) + IF(measuring_value_interval_140 IS NULL, 0, 1) + IF(measuring_value_interval_141 IS NULL, 0, 1) + IF(measuring_value_interval_142 IS NULL, 0, 1) + IF(measuring_value_interval_143 IS NULL, 0, 1) + IF(measuring_value_interval_144 IS NULL, 0, 1)))) AS daily_avg, \'farm' AS wind_farm \
                            FROM \
                                lvs_measuring_data.wind_turbine_unit_measuring_data_daily \
                            WHERE \
                                wind_turbine_serial_id_fk IN (:turbines) \
                                    AND variable_id_fk IN (:variables) \
                                    AND value_type_id_fk IN (:type) \
                                    AND measuring_date >= :start_date \
                                    AND measuring_date <= :end_date) t1 \
                        GROUP BY variable_id_fk, value_type_id_fk "

 lvs_db.sequelize.query(query_string, {
         replacements:{
            turbines: [turbines],
            variables:[params.variable] ,
            start_date: params.start_date ,
            end_date: params.end_date ,
            type:params.type
         },
         type: sequelize.QueryTypes.SELECT
     }).then(function(data) {
      callback(true, 200, "Success", data);
  }).catch(function(err) {
      console.log(err)
      callback(false, 300, "Error : " +  err, {});
  });
}